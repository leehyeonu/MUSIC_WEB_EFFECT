<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Lyric Sync â€“ Santa Tell Me</title>
<style>
  :root {
    --neon: #00f5ff;
    --accent: #6aa8ff;
    --dark: #07070b;
  }
  * { box-sizing: border-box; }
  html, body {
    height: 100%;
    margin: 0;
    background: radial-gradient(60% 80% at 50% 20%, #0f1320 0%, #090b12 55%, var(--dark) 100%);
    color: #eef4ff;
    font-family: Pretendard, system-ui, -apple-system, sans-serif;
    overflow: hidden;
  }
  
  .stage {
    position: relative;
    width: 100vw;
    height: 100vh;
    display: flex;
    flex-direction: column;
  }

  /* ìƒë‹¨ ì˜¤ë””ì˜¤ ì»¨íŠ¸ë¡¤ */
  .topbar {
    flex-shrink: 0;
    padding: max(12px, env(safe-area-inset-top)) 16px 12px;
    background: linear-gradient(180deg, rgba(7,7,11,.9) 0%, transparent);
    z-index: 20;
  }
  audio {
    width: 100%;
    height: 32px;
    accent-color: var(--accent);
  }

  /* ì½˜í…ì¸  ì˜ì—­ */
  .content {
    position: relative;
    flex: 1;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: max(8px, env(safe-area-inset-bottom));
  }

  /* ì‚°íƒ€: ì ˆëŒ€ ì™¼ìª½ í•˜ë‹¨, ê²¹ì¹¨ ì—†ìŒ */
  .santa-box {
    position: absolute;
    left: 10px;
    bottom: 10%;
    width: clamp(100px, 22vw, 200px);
    height: clamp(100px, 22vw, 200px);
    display: flex;
    align-items: flex-end;
    justify-content: center;
    z-index: 5;
    pointer-events: none;
  }
  .santa {
    font-size: 100%;
    line-height: 1;
    animation: bounce 2.4s ease-in-out infinite, wobble 3.6s ease-in-out infinite;
    filter: drop-shadow(0 8px 24px rgba(255, 0, 64, .4));
  }
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-12px); }
  }
  @keyframes wobble {
    0%, 100% { transform: rotateZ(-5deg); }
    50% { transform: rotateZ(5deg); }
  }

  /* ê°€ì‚¬ ì¹´ë“œ: ìš°ì¸¡ ì¤‘ì‹¬ */
  .glass {
    position: absolute;
    right: 16px;
    left: 16px;
    bottom: 10%;
    max-width: 700px;
    width: calc(100% - 32px);
    margin: 0 auto;
    padding: 24px 28px;
    border-radius: 16px;
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
    box-shadow: 0 14px 56px rgba(0, 0, 0, 0.5), inset 0 1px 1px rgba(255, 255, 255, 0.1);
    z-index: 10;
  }

  .lyric {
    margin: 0;
    font-size: clamp(26px, 6.5vw, 40px);
    font-weight: 700;
    line-height: 1.4;
    letter-spacing: 0.5px;
    color: #fff;
    text-shadow:
      0 0 10px #fff,
      0 0 24px #fff,
      0 0 40px var(--neon),
      0 0 80px var(--neon);
    min-height: 2em;
    word-break: keep-all;
    overflow-wrap: break-word;
    animation: pulse 0.8s ease-in-out;
  }
  @keyframes pulse {
    0% { opacity: 0.7; transform: scale(0.98); }
    50% { opacity: 1; transform: scale(1.02); }
    100% { opacity: 1; transform: scale(1); }
  }

  .gradient {
    background: linear-gradient(90deg, var(--accent), var(--neon) 50%, #86ffd6);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    color: transparent;
  }

  .progress {
    height: 6px;
    width: 100%;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 4px;
    overflow: hidden;
    margin-top: 16px;
  }
  .progress > span {
    display: block;
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, var(--accent), var(--neon) 60%, #fff);
    box-shadow: 0 0 16px var(--neon);
    transition: width 0.1s linear;
  }

  .cursor::after {
    content: "";
    display: inline-block;
    width: 2.5px;
    height: 0.9em;
    margin-left: 5px;
    background: currentColor;
    animation: blink 0.8s steps(1) infinite;
    vertical-align: -0.15em;
  }
  @keyframes blink { 50% { opacity: 0.3; } }

  @media (max-width: 480px) {
    .glass { padding: 20px 20px; }
    .lyric { font-size: clamp(22px, 5.5vw, 34px); }
  }
</style>

<div class="stage">
  <div class="topbar">
    <audio id="player" crossorigin="anonymous"></audio>
  </div>

  <div class="content">
    <div class="santa-box">
      <div class="santa">ğŸ…</div>
    </div>

    <div class="glass">
      <h2 id="lyric" class="lyric gradient cursor">Tap play to startâ€¦</h2>
      <div class="progress"><span id="bar"></span></div>
    </div>
  </div>
</div>

<script>
// í˜ì´ì§€ ë¡œë“œ ì¦‰ì‹œ: LRC íŒŒì‹± ë° ì˜¤ë””ì˜¤ ë¡œë“œ
const AUDIO_FILE = "song.mp3"; // â† íŒŒì¼ëª…ë§Œ ìˆ˜ì •í•˜ì„¸ìš”
const audio = document.getElementById('player');
const lyricEl = document.getElementById('lyric');
const barEl = document.getElementById('bar');

function parseLRC(text) {
  const tag = /\[(\d{1,2}):(\d{2})(?:\.(\d{1,3}))?\]/g;
  const lines = [];
  for (const raw of text.split(/\r?\n/)) {
    const matches = [...raw.matchAll(tag)];
    if (!matches.length) continue;
    const lyric = raw.slice(matches[matches.length - 1].index + matches[matches.length - 1][0].length).trim();
    for (const m of matches) {
      const mm = +m[1], ss = +m[2], frac = (m[3] || '0').padEnd(3, '0');
      lines.push([(mm * 60 + ss) * 1000 + +frac, lyric]);
    }
  }
  return lines.sort((a, b) => a[0] - b[0]);
}

const lrcNode = document.getElementById('lrc');
const timeline = lrcNode ? parseLRC(lrcNode.textContent) : [];

let idx = 0, lastIdx = -1;

audio.src = AUDIO_FILE;

// ì˜¤ë””ì˜¤ ë©”íƒ€ ë¡œë“œ ì™„ë£Œ ì‹œ ì¤€ë¹„
let canSync = false;
audio.addEventListener('loadedmetadata', () => { canSync = true; });

// ì‚¬ìš©ì ì²« ì œìŠ¤ì²˜ì—ì„œë§Œ ì¬ìƒ ì‹œì‘ (ëª¨ë°”ì¼ ì •ì±…)
window.addEventListener('click', () => {
  if (audio.paused && audio.src) audio.play().catch(() => {});
}, { once: true });

function showLine(text) {
  lyricEl.textContent = text || " ";
}

function tick() {
  requestAnimationFrame(tick);

  // ì¡°ê±´: 1) ë™ê¸°í™” ì¤€ë¹„ ë¨, 2) íƒ€ì„ë¼ì¸ ìˆìŒ, 3) ì˜¤ë””ì˜¤ ë°ì´í„° ì¤€ë¹„, 4) ì‹¤ì œ ì¬ìƒ ì¤‘
  if (!canSync || !timeline.length || isNaN(audio.duration) || audio.paused) {
    return;
  }

  const pos = audio.currentTime * 1000;

  // í˜„ì¬ ìœ„ì¹˜ì— ë§ëŠ” ë¼ì¸ ì°¾ê¸°
  while (idx + 1 < timeline.length && pos >= timeline[idx + 1][0]) {
    idx++;
  }

  // ë¼ì¸ ë³€ê²½ ì‹œë§Œ ì—…ë°ì´íŠ¸
  if (lastIdx !== idx) {
    lastIdx = idx;
    showLine(timeline[idx][1]);
  }

  // ì§„í–‰ ë°”
  const [t] = timeline[idx];
  const nextT = (idx + 1 < timeline.length) ? timeline[idx + 1][0] : (audio.duration * 1000);
  const pct = Math.max(0, Math.min(1, (pos - t) / Math.max(1, nextT - t)));
  barEl.style.width = (pct * 100).toFixed(1) + '%';
}

tick();
</script>

<!-- ì—¬ê¸°ì— ë³¸ì¸ì˜ LRCë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš” -->
<script id="lrc" type="text/plain">
[id: pshzibvw]
[ar: Ariana Grande]
[al: Santa Tell Me - Single]
[ti: Ariana Grande - Santa Tell Me]
[by: ig:@eriksn.egr]

[re: LRC Editor - Android app]
[ve: Version 3.2.6]

[00:00.00]
[00:10.08]Santa, tell me if you're really there
[00:13.83]Don't make me fall in love again
[00:16.56]If he won't be here next year
[00:19.82]Santa, tell me if he really cares
[00:23.84]'Cause I can't give it all away
[00:26.47]If he won't be here next year
[00:30.19]Feeling Christmas all around
[00:32.75]And I'm trying to play it cool
[00:35.29]But it's hard to focus when I see him walkin' 'cross the room
[00:40.41]"Let it Snow" is blasting out
[00:42.66]But I won't get in the mood
[00:45.28]I'm avoiding every mistletoe until I know
[00:49.35]It's true love that he thinks of
[00:53.45]So next Christmas
[00:55.82]I'm not all alone, boy
[01:00.09]Santa, tell me if you're really there
[01:03.97]Don't make me fall in love again
[01:06.52]If he won't be here next year
[01:09.79]Santa, tell me if he really cares
[01:13.91]'Cause I can't give it all away
[01:16.89]If he won't be here next year
[01:20.27]I've been down this road before
[01:23.76]Fell in love on Christmas night (ooh, babe)
[01:26.31]But on New Year's Day, I woke up and he wasn't by my side
[01:31.27]Now I need someone to hold
[01:33.79]Be my fire in the cold (yeah, yeah)
[01:36.36]But it's hard to tell if this is just a fling
[01:39.54]Or if it's true love that he thinks of (of)
[01:44.47]So next Christmas
[01:46.96]I'm not all alone, babe
[01:50.53]Santa, tell me if you're really there
[01:55.10]Don't make me fall in love again
[01:57.50]If he won't be here next year
[02:01.07]Santa, tell me if he really cares
[02:05.04]'Cause I can't give it all away
[02:07.48]If he won't be here next year
[02:12.46]Oh, I wanna have him beside me like oh-oh-oh
[02:17.20]On the 25th by the fire place, oh-oh-oh
[02:21.90]But I don't want a new broken heart
[02:25.56]This year I've got to be smart
[02:29.81]Ooh, baby
[02:30.95](Santa, tell me, Santa, tell me)
[02:34.34]If he will be, if he will be
[02:36.81](Santa, tell me, Santa, tell me)
[02:38.96]Oh-oh-oh
[02:41.22]Santa, tell me if you're really there (Santa, tell me, 'cause I really care)
[02:44.99]Don't make me fall in love again
[02:47.55]If he won't be here next year
[02:50.99]Santa, tell me if he really cares (tell me, tell me, boy)
[02:54.96]'Cause I can't give it all away
[02:57.72]If he won't be here next year
[03:01.27]Santa, tell me if you're really there (tell me, tell me, baby)
[03:05.06]Don't make me fall in love again
[03:07.73]If he won't be here next year (if he won't be, if he won't be here)
[03:11.05]Santa, tell me if he really cares (tell me, do you care?)
[03:14.96]'Cause I can't give it all away
[03:17.46]If he won't be here next year
</script>
